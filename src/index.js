import React from 'react';
import ReactDOM from 'react-dom';
import 'normalize.css';
import './public/index.css';
import Card from './components/Card';
import CardsList from './components/CardsList';
import FilterBlock from './components/FilterBlock';
import SelectField from './components/SelectField';
import SearchField from './components/SearchField';
import SwitchPrice from './components/SwitchPrice';

class App extends React.Component {
  constructor() {
    super();
    this.showItems = this.showItems.bind(this);
    this.filterFormHandle = this.filterFormHandle.bind(this);
    this.gradeTransform = this.gradeTransform.bind(this);
    this.togglePriceHandle = this.togglePriceHandle.bind(this);
    this.state = {
      items: null,
      isPriceInMoney: true,
      isSearchResult: false,
      fetchDataError: false
    };
    this.dataItems = null;
    this.filtersData = {
      subjectFilter: new Set(),
      genreFilter: new Set(),
      gradeFilter: new Set()
    }
  }

  componentDidMount() {
    /*fetch('http://krapipl.imumk.ru:8082/api/mobilev1/update', {
      method: 'POST',
      headers: {'Content-type': 'application/json'},
      body: JSON.stringify({'data': ''})
    })
    .then((response) => {
      if (response.status === 200) {
        response.json().then((data) => {
          if (data.result === "Ok") {
            this.dataItems = data.items;
            this.dataItems.forEach((item) => {
              this.filtersData.subjectFilter.add(item.subject);
              this.filtersData.genreFilter.add(item.genre);
              this.filtersData.gradeFilter.add(item.grade);
            });
            this.setState((state, props) => {
              return {items: this.dataItems}
            });
            return true;
          }
          throw new Error('Не удалось получить данные');
        });
      }
    })
    .catch((err) => {
      this.setState(() => {
        return {
          fetchDataError: true
        }
      });
    });*/
    this.dataItems = [{"courseId":"80","extId":"Physicon_IMUMK_Course_267727","courseHash":"318195250115271701719214121150250168217123912252217","title":"Рабочая тетрадь. Алгебра, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Алгебра","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267727","progress":0,"description":"280 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/103","google_id":"ru.fizikon.physicon_imumk_course_267727","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"81","extId":"Physicon_IMUMK_Course_267728","courseHash":"20474204246309206195154243821962081072919715989470","title":"Рабочая тетрадь. Алгебра, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Алгебра","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267728","progress":0,"description":"220 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/104","google_id":"ru.fizikon.physicon_imumk_course_267728","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"82","extId":"Physicon_IMUMK_Course_267729","courseHash":"882101439242897615612422322382101124210129222068273","title":"Рабочая тетрадь. Алгебра, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Алгебра","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267729","progress":0,"description":"220 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/105","google_id":"ru.fizikon.physicon_imumk_course_267729","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4183","extId":"Physicon_IMUMK_Course_357430","courseHash":"126861564211313771214133104255173173975413013073110164","title":"Тренажёр по подготовке к ЕГЭ-2018. Английский язык","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Английский язык","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357430","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/257","google_id":"ru.fizikon.physicon_imumk_course_357430","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"55","extId":"Physicon_IMUMK_Course_267724","courseHash":"422521216518694124571452409016321213367253229850250","title":"Рабочая тетрадь. Естествознание, 5 класс","grade":"5","genre":"Рабочая тетрадь","subject":"Биология","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267724","progress":0,"description":"180 интерактивных заданий, \n3 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-100","google_id":"ru.fizikon.physicon_imumk_course_267724","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"61","extId":"Physicon_IMUMK_Course_267720","courseHash":"10999636811136421382541264422812821198911319259229","title":"Рабочая тетрадь. Биология, 6 класс","grade":"6","genre":"Рабочая тетрадь","subject":"Биология","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267720","progress":0,"description":"190 интерактивных заданий, \n3 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-85","google_id":"ru.fizikon.physicon_imumk_course_267720","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"27","extId":"Physicon_IMUMK_Course_267721","courseHash":"80229147931161614971215133791841683421713251235181196","title":"Рабочая тетрадь. Биология, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Биология","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267721","progress":0,"description":"300 интерактивных заданий, \r\n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-86","google_id":"ru.fizikon.physicon_imumk_course_267721","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"50","extId":"Physicon_IMUMK_Course_267722","courseHash":"5818797474136332411412614684972072212433422963116","title":"Рабочая тетрадь. Биология, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Биология","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267722","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-87","google_id":"ru.fizikon.physicon_imumk_course_267722","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"79","extId":"Physicon_IMUMK_Course_278049","courseHash":"115414972161922512331631121131118196241072021318162","title":"Задачник. Биология: 8–11 класс","grade":"8;9;10;11","genre":"Задачник","subject":"Биология","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_278049","progress":0,"description":"700 интерактивных заданий и 7 контрольных работ","status":"","price":1000,"shopUrl":"https://www.imumk.ru/offer/-110","google_id":"ru.fizikon.physicon_imumk_course_278049","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"51","extId":"Physicon_IMUMK_Course_267723","courseHash":"13913869341007279197220128146718313103531814142","title":"Рабочая тетрадь. Биология, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Биология","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267723","progress":0,"description":"300 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-88","google_id":"ru.fizikon.physicon_imumk_course_267723","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4186","extId":"Physicon_IMUMK_Course_357675","courseHash":"213819524516865103129992461546289756259542007495","title":"Тренажёр по подготовке к ЕГЭ-2018. Биология","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Биология","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357675","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/247","google_id":"ru.fizikon.physicon_imumk_course_357675","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"3967","extId":"Physicon_IMUMK_Course_323883","courseHash":"176682194037683620431246015363589249112501972","title":"Тренажёр по подготовке к ВПР-2017. Биология","grade":"11","genre":"Подготовка к ВПР","subject":"Биология","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323883","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/243","google_id":"ru.fizikon.physicon_imumk_course_323883","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4290","extId":"Physicon_IMUMK_Course_323957","courseHash":"68218107253143181852068120523880141612523312112114174","title":"Тренажёр по подготовке к ВПР-2018. Биология","grade":"11","genre":"Подготовка к ВПР","subject":"Биология","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323957","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/278","google_id":"","winstore_id":"","isNew":false,"priceBonus":6000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"56","extId":"Physicon_IMUMK_Course_267736","courseHash":"81551377359539910123116622620967247147743190202","title":"Рабочая тетрадь. География, 6 класс","grade":"6","genre":"Рабочая тетрадь","subject":"География","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267736","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-91","google_id":"ru.fizikon.physicon_imumk_course_267736","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"57","extId":"Physicon_IMUMK_Course_267737","courseHash":"16014115160108720105651821559417123420892932821528","title":"Рабочая тетрадь. География, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"География","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267737","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-92","google_id":"ru.fizikon.physicon_imumk_course_267737","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"53","extId":"Physicon_IMUMK_Course_267738","courseHash":"15614916420212234121200121121264322623015753150452474","title":"Рабочая тетрадь. География, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"География","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267738","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-93","google_id":"ru.fizikon.physicon_imumk_course_267738","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"58","extId":"Physicon_IMUMK_Course_267739","courseHash":"18014514513081184212172474419681230102368820616621982","title":"Рабочая тетрадь. География, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"География","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267739","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-94","google_id":"ru.fizikon.physicon_imumk_course_267739","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4187","extId":"Physicon_IMUMK_Course_357735","courseHash":"662401267511212118210015422864221438492394177654","title":"Тренажёр по подготовке к ЕГЭ-2018. География","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"География","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357735","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/248","google_id":"ru.fizikon.physicon_imumk_course_357735","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"3897","extId":"Physicon_IMUMK_Course_323737","courseHash":"7639160451480163113637970462425821457167103683","title":"Тренажёр по подготовке к ВПР-2017. География","grade":"11","genre":"Подготовка к ВПР","subject":"География","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323737","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/244","google_id":"ru.fizikon.physicon_imumk_course_323737","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4297","extId":"Physicon_IMUMK_Course_323948","courseHash":"6021380181203231239247122126243233621012269143428141","title":"Тренажёр по подготовке к ВПР-2018. География","grade":"11","genre":"Подготовка к ВПР","subject":"География","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323948","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/276","google_id":"","winstore_id":"","isNew":false,"priceBonus":6000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"76","extId":"Physicon_IMUMK_Course_267730","courseHash":"2442286921131968831812441732610715281130168248210","title":"Рабочая тетрадь. Геометрия, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Геометрия","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267730","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/106","google_id":"ru.fizikon.physicon_imumk_course_267730","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"77","extId":"Physicon_IMUMK_Course_267731","courseHash":"2710822424218610324916925531961391141619715312622210685","title":"Рабочая тетрадь. Геометрия, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Геометрия","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267731","progress":0,"description":"170 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/107","google_id":"ru.fizikon.physicon_imumk_course_267731","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"78","extId":"Physicon_IMUMK_Course_267732","courseHash":"23119339131175260572625119835509416714361402418","title":"Рабочая тетрадь. Геометрия, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Геометрия","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267732","progress":0,"description":"200 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/108","google_id":"ru.fizikon.physicon_imumk_course_267732","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"67","extId":"Physicon_IMUMK_Course_267733","courseHash":"219215114782452362311032722612815863118195112321441579","title":"Рабочая тетрадь. Информатика, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Информатика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267733","progress":0,"description":"140 интерактивных заданий, \r\n2 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/109","google_id":"ru.fizikon.physicon_imumk_course_267733","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"69","extId":"Physicon_IMUMK_Course_267734","courseHash":"2514320124322329215657337561511690651532409118325","title":"Рабочая тетрадь. Информатика, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Информатика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267734","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/110","google_id":"ru.fizikon.physicon_imumk_course_267734","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"68","extId":"Physicon_IMUMK_Course_267735","courseHash":"6288141171291225912750236250154173355521650475036","title":"Рабочая тетрадь. Информатика, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Информатика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267735","progress":0,"description":"250 интерактивных заданий, \r\n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/111","google_id":"ru.fizikon.physicon_imumk_course_267735","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4178","extId":"Physicon_IMUMK_Course_357105","courseHash":"1291041881911475315187215103231192181813788135859","title":"Тренажёр по подготовке к ЕГЭ-2018. Информатика (Паскаль)","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Информатика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357105","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/2949","google_id":"ru.fizikon.physicon_imumk_course_357105","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4179","extId":"Physicon_IMUMK_Course_357104","courseHash":"2481391062161618834446665186761894249129104248227","title":"Тренажёр по подготовке к ЕГЭ-2018. Информатика (С++)","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Информатика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357104","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/2950","google_id":"ru.fizikon.physicon_imumk_course_357104","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"48","extId":"Physicon_IMUMK_Course_267740","courseHash":"1141261785317524457145385922711916414323023115810039","title":"Рабочая тетрадь. История, 5 класс","grade":"5","genre":"Рабочая тетрадь","subject":"История","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267740","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-95","google_id":"ru.fizikon.physicon_imumk_course_267740","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"65","extId":"Physicon_IMUMK_Course_267741","courseHash":"12944471321511331991849822251895619323197135165234","title":"Рабочая тетрадь. История, 6 класс","grade":"6","genre":"Рабочая тетрадь","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267741","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-96","google_id":"ru.fizikon.physicon_imumk_course_267741","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"64","extId":"Physicon_IMUMK_Course_267742","courseHash":"2302162421724520411122022081218762312221649871216758","title":"Рабочая тетрадь. История, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267742","progress":0,"description":"290 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-97","google_id":"ru.fizikon.physicon_imumk_course_267742","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"62","extId":"Physicon_IMUMK_Course_267743","courseHash":"1692221266432153065410011324153741102350235174218","title":"Рабочая тетрадь. История, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267743","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-98","google_id":"ru.fizikon.physicon_imumk_course_267743","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"63","extId":"Physicon_IMUMK_Course_267744","courseHash":"7831119241126912461101181341572151633237245243109210","title":"Рабочая тетрадь. История, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK2_Course_267744","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-99","google_id":"ru.fizikon.physicon_imumk_course_267744","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4182","extId":"Physicon_IMUMK_Course_357368","courseHash":"1802111991322696521058625460211191175113920141157106","title":"Тренажёр по подготовке к ЕГЭ-2018. История","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357368","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/250","google_id":"ru.fizikon.physicon_imumk_course_357368","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4292","extId":"Physicon_IMUMK_Course_323954","courseHash":"99116123467011823417016619868251173611911111110010086","title":"Тренажёр по подготовке к ВПР-2018. История","grade":"11","genre":"Подготовка к ВПР","subject":"История","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323954","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/282","google_id":"","winstore_id":"","isNew":false,"priceBonus":6000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4304","extId":"Physicon_IMUMK_Course_360001","courseHash":"5418617819975121242311521882062351551302462542442064219","title":"Тренажёр по подготовке к ЕГЭ-2018. Литература","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Литература","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_360001","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/284","google_id":"","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"74","extId":"Physicon_IMUMK_Course_267725","courseHash":"236551492074019578831875824913174165239418813024130","title":"Рабочая тетрадь. Математика, 5 класс","grade":"5","genre":"Рабочая тетрадь","subject":"Математика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267725","progress":0,"description":"220 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-104","google_id":"ru.fizikon.physicon_imumk_course_267725","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"75","extId":"Physicon_IMUMK_Course_267726","courseHash":"15823711134221110130202232220175183212215522176229236216","title":"Рабочая тетрадь. Математика, 6 класс","grade":"6","genre":"Рабочая тетрадь","subject":"Математика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267726","progress":0,"description":"240 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-105","google_id":"ru.fizikon.physicon_imumk_course_267726","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4176","extId":"Physicon_IMUMK_Course_357001","courseHash":"1352551661927810613275124134145220824314324316013225161","title":"Тренажёр по подготовке к ЕГЭ-2018. Математика (базовый)","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Математика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357001","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/251","google_id":"ru.fizikon.physicon_imumk_course_357001","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4177","extId":"Physicon_IMUMK_Course_357054","courseHash":"202711731516518418612824813613115718067882610113814470","title":"Тренажёр по подготовке к ЕГЭ-2018. Математика (профильный)","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Математика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357054","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/252","google_id":"ru.fizikon.physicon_imumk_course_357054","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4181","extId":"Physicon_IMUMK_Course_357298","courseHash":"2112216512430221136183156161557714618222823721225514899","title":"Тренажёр по подготовке к ЕГЭ-2018. Обществознание","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Обществознание","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357298","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/253","google_id":"ru.fizikon.physicon_imumk_course_357298","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"111","extId":"Physicon_IMUMK_Course_280864","courseHash":"53103206223208150212165202200209118203931201602033053","title":"Рабочая тетрадь. Окружающий мир, 1 класс","grade":"1","genre":"Рабочая тетрадь","subject":"Окружающий мир","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_280864","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/183","google_id":"ru.fizikon.physicon_imumk_course_280864","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"108","extId":"Physicon_IMUMK_Course_281595","courseHash":"12920322173723417966199684916516116235471671051","title":"Рабочая тетрадь. Окружающий мир, 2 класс","grade":"2","genre":"Рабочая тетрадь","subject":"Окружающий мир","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_281595","progress":0,"description":"270 интерактивных заданий,6 тематических контрольных работ","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/184","google_id":"ru.fizikon.physicon_imumk_course_281595","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"109","extId":"Physicon_IMUMK_Course_282584","courseHash":"2176074512053140186891491811418718912715820215941183","title":"Рабочая тетрадь. Окружающий мир, 3 класс","grade":"3","genre":"Рабочая тетрадь","subject":"Окружающий мир","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_282584","progress":0,"description":"250 интерактивных заданий, 4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/185","google_id":"ru.fizikon.physicon_imumk_course_282584","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"110","extId":"Physicon_IMUMK_Course_283885","courseHash":"10225067929277116123962191781591417820411917123413759","title":"Рабочая тетрадь. Окружающий мир, 4 класс","grade":"4","genre":"Рабочая тетрадь","subject":"Окружающий мир","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_283885","progress":0,"description":"280 интерактивных заданий, 4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/186","google_id":"ru.fizikon.physicon_imumk_course_283885","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4188","extId":"Physicon_IMUMK_Course_317823","courseHash":"32070215100222101782510791147147317923463387202","title":"Рабочая тетрадь. Робототехника, 1-4 классы","grade":"1;2;3;4","genre":"Рабочая тетрадь","subject":"Робототехника","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_317823","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/258","google_id":"ru.fizikon.physicon_imumk_course_317823","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4169","extId":"Physicon_IMUMK_Course_316798","courseHash":"20916155207100217126737244164170167130152229131194613","title":"Рабочая тетрадь. Робототехника, 7-9 классы","grade":"7;8;9","genre":"Рабочая тетрадь","subject":"Робототехника","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_316798","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/259","google_id":"ru.fizikon.physicon_imumk_course_316798","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4170","extId":"Physicon_IMUMK_Course_317789","courseHash":"60902181565911345632427124254250222162265019814838","title":"Рабочая тетрадь. Робототехника, 10-11 классы","grade":"10;11","genre":"Рабочая тетрадь","subject":"Робототехника","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_317789","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/260","google_id":"ru.fizikon.physicon_imumk_course_317789","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"83","extId":"Physicon_IMUMK_Course_279189","courseHash":"40190168114206232247147871101601016128216133572458797","title":"Рабочая тетрадь. Русский язык, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Русский язык","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_279189","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-111","google_id":"ru.fizikon.physicon_imumk_course_279189","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"84","extId":"Physicon_IMUMK_Course_279539","courseHash":"19218209756825211825382820421896228131101191548166","title":"Рабочая тетрадь. Русский язык, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Русский язык","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_279539","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-112","google_id":"ru.fizikon.physicon_imumk_course_279539","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"85","extId":"Physicon_IMUMK_Course_279740","courseHash":"1115622524932243250202711141346015710912411024224213","title":"Рабочая тетрадь. Русский язык, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Русский язык","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_279740","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-113","google_id":"ru.fizikon.physicon_imumk_course_279740","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4180","extId":"Physicon_IMUMK_Course_357236","courseHash":"2232094325443217156182364421418587618511756173103","title":"Тренажёр по подготовке к ЕГЭ-2018. Русский язык","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Русский язык","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357236","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/254","google_id":"ru.fizikon.physicon_imumk_course_357236","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"70","extId":"Physicon_IMUMK_Course_267715","courseHash":"318982151583878315557171149011202128245821843","title":"Рабочая тетрадь. Физика, 7 класс","grade":"7","genre":"Рабочая тетрадь","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267715","progress":0,"description":"290 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/112","google_id":"ru.fizikon.physicon_imumk_course_267715","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"73","extId":"Physicon_IMUMK_Course_267716","courseHash":"47175416244243100681242271351311718421024611183191","title":"Рабочая тетрадь. Физика, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267716","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/113","google_id":"ru.fizikon.physicon_imumk_course_267716","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"72","extId":"Physicon_IMUMK_Course_267717","courseHash":"2295323957139112130191161445678243281341654319043175","title":"Рабочая тетрадь. Физика, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_267717","progress":0,"description":"490 интерактивных заданий, \n4 тематические контрольные работы","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/114","google_id":"ru.fizikon.physicon_imumk_course_267717","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4184","extId":"Physicon_IMUMK_Course_357522","courseHash":"22122151681682441619611605125114922569767320414843","title":"Тренажёр по подготовке к ЕГЭ-2018. Физика","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357522","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/255","google_id":"ru.fizikon.physicon_imumk_course_357522","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"132","extId":"Physicon_IMUMK_Course_307641","courseHash":"44250141723131103382161882331321225157179721313040","title":"Задачник. Физика: квантовая физика, 10-11 класс.","grade":"10;11","genre":"Задачник","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_307641","progress":0,"description":"540 интерактивных заданий, 6 тематических контрольных работ","status":"","price":600,"shopUrl":"https://www.imumk.ru/offer/236","google_id":"ru.fizikon.physicon_imumk_course_307641","winstore_id":"","isNew":false,"priceBonus":3000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"133","extId":"Physicon_IMUMK_Course_307642","courseHash":"7416613188196199542312242072341689157230246148218180208","title":"Задачник. Физика: Термодинамика и МКТ, 10–11 класс.","grade":"10;11","genre":"Задачник","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_307642","progress":0,"description":"450 интерактивных заданий, 6 тематических контрольных работ","status":"","price":600,"shopUrl":"https://www.imumk.ru/offer/237","google_id":"ru.fizikon.physicon_imumk_course_307642","winstore_id":"","isNew":false,"priceBonus":3000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"134","extId":"Physicon_IMUMK_Course_308048","courseHash":"10515610124286243982397125421526132105791281073317179","title":"Задачник. Физика: оптика, 10-11 класс.","grade":"10;11","genre":"Задачник","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_308048","progress":0,"description":"","status":"","price":600,"shopUrl":"https://www.imumk.ru/offer/2069","google_id":"ru.fizikon.physicon_imumk_course_308048","winstore_id":"","isNew":false,"priceBonus":3000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"3903","extId":"Physicon_IMUMK_Course_323781","courseHash":"2153148118812712319014840662212411082723220123255190","title":"Тренажёр по подготовке к ВПР-2017. Физика","grade":"11","genre":"Подготовка к ВПР","subject":"Физика","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323781","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/246","google_id":"ru.fizikon.physicon_imumk_course_323781","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"60","extId":"Physicon_IMUMK_Course_267718","courseHash":"181691851282283030981562181642321462121912291021325584","title":"Рабочая тетрадь. Химия, 8 класс","grade":"8","genre":"Рабочая тетрадь","subject":"Химия","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267718","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-89","google_id":"ru.fizikon.physicon_imumk_course_267718","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"59","extId":"Physicon_IMUMK_Course_267719","courseHash":"20616722216315211623551149209236477579215291436167195","title":"Рабочая тетрадь. Химия, 9 класс","grade":"9","genre":"Рабочая тетрадь","subject":"Химия","itunes_id":"ru.physicon.imumk.WB.Physicon_IMUMK2_Course_267719","progress":0,"description":"","status":"free","price":400,"shopUrl":"https://www.imumk.ru/offer/-90","google_id":"ru.fizikon.physicon_imumk_course_267719","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4185","extId":"Physicon_IMUMK_Course_357595","courseHash":"12919118714425225521714052259217126947031171106153109","title":"Тренажёр по подготовке к ЕГЭ-2018. Химия","grade":"10;11","genre":"Подготовка к ЕГЭ","subject":"Химия","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_357595","progress":0,"description":"","status":"free","price":600,"shopUrl":"https://www.imumk.ru/offer/256","google_id":"ru.fizikon.physicon_imumk_course_357595","winstore_id":"","isNew":false,"priceBonus":5000,"lang":"ru","size":0,"requireUpdate":false},{"courseId":"4291","extId":"Physicon_IMUMK_Course_323960","courseHash":"3820523974220785107260164761651381811402853215","title":"Тренажёр по подготовке к ВПР-2018. Химия","grade":"11","genre":"Подготовка к ВПР","subject":"Химия","itunes_id":"ru.physicon.imumk.Physicon_IMUMK_Course_323960","progress":0,"description":"","status":"","price":400,"shopUrl":"https://www.imumk.ru/offer/280","google_id":"","winstore_id":"","isNew":false,"priceBonus":6000,"lang":"ru","size":0,"requireUpdate":false}];
    this.dataItems.forEach((item) => {
      this.filtersData.subjectFilter.add(item.subject);
      this.filtersData.genreFilter.add(item.genre);
      this.filtersData.gradeFilter.add(item.grade);
    });
    this.setState((state, props) => {
      return {items: this.dataItems}
    });
  }

  showItems() {
    const items = this.state.items;
    if (!items) {
      return;
    }
    let cards = items.map((item) => {
      return (
        <Card
          subject={item.subject}
          grade={this.gradeTransform(item.grade)}
          genre={item.genre}
          price={this.state.isPriceInMoney ? item.price : item.priceBonus}
          courseId={item.courseId}
          key={item.courseId}
        />
      );
    });
    return (
      <CardsList cards={cards} />
    );
  }

  filterFormHandle(form) {
    let resultItems = this.dataItems;
    const subject = form.subject.value;
    const genre = form.genre.value;
    const grade = form.grade.value;
    const search = form.search.value.trim();

    if (subject !== '') {
      resultItems = resultItems.filter((item) => {
        return subject === item.subject;
      });
    }
    if (genre !== '') {
      resultItems = resultItems.filter((item) => {
        return genre === item.genre;
      });
    }
    if (grade !== '') {
      resultItems = resultItems.filter((item) => {
        let gradesAr = item.grade.split(';');
        return gradesAr.some((item) => {
          return grade === item;
        });
      });
    }
    if (search !== '') {
      resultItems = resultItems.filter((item) => {
        return item.title.toLowerCase().includes(search.toLowerCase());
      });
    }

    this.setState(() => {
      let isSearchResult = false;
      if (resultItems.length === this.dataItems.length) {
        isSearchResult = false;
      } else {
        isSearchResult = true;
      }

      return {
        items: resultItems,
        isSearchResult: isSearchResult
      }
    })
  }

  gradeTransform(item) {
    const grades = item.split(';');
    const gradesLength = grades.length;
    if (gradesLength === 1) {
      return `${grades[0]} класс`;
    }
    return `${grades[0]}-${grades[gradesLength - 1]} классы`;
  }

  togglePriceHandle(value) {
    this.setState(() => {
      return {isPriceInMoney: value}
    });
  }

  render() {
    return (
      <React.Fragment>
        <SwitchPrice
          togglePriceHandle={this.togglePriceHandle}
          isPriceInMoney={this.state.isPriceInMoney}
        />
        <div className="showcase">
          <h1 className="showcase__title">Витрина</h1>
          <FilterBlock filterFormHandle={this.filterFormHandle}>
            <SelectField
              filterName="subject"
              defaultValue="Все предметы"
              items={this.filtersData.subjectFilter}
              filterFormHandle={this.filterFormHandle}
            />
            <SelectField
              filterName="genre"
              defaultValue="Все жанры"
              items={this.filtersData.genreFilter}
              filterFormHandle={this.filterFormHandle}
            />
            <SelectField
              filterName="grade"
              defaultValue="Все классы"
              items={[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]}
              filterFormHandle={this.filterFormHandle}
            />
            <SearchField filterFormHandle={this.filterFormHandle} />
          </FilterBlock>
          {this.state.isSearchResult && <h2 className="showcase__search-title">Результаты поиска:</h2>}
          {
            this.state.fetchDataError ?
              <div className="showcase__fetch-data-error">Не удалось получить данные</div> : this.showItems()
          }
        </div>
      </React.Fragment>
    );
  }
}

ReactDOM.render(
  <App />,
  document.getElementById('root')
);